"use strict";(self.webpackChunkbeta_BNB_Docs=self.webpackChunkbeta_BNB_Docs||[]).push([[8915],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},d=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},h="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),h=c(a),u=r,m=h["".concat(l,".").concat(u)]||h[u]||p[u]||o;return a?n.createElement(m,s(s({ref:t},d),{},{components:a})):n.createElement(m,s({ref:t},d))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[h]="string"==typeof e?e:r,s[1]=i;for(var c=2;c<o;c++)s[c]=a[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},73877:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var n=a(83117),r=(a(67294),a(3905));const o={sidebar_label:"Storage Economics and Its Primitives"},s="Storage Economics and Its Primitives",i={unversionedId:"greenfield/design/storage-economics",id:"greenfield/design/storage-economics",title:"Storage Economics and Its Primitives",description:"In this section, the underlying economics and the operating primitives are discussed aligned with the lifecycle of a data object. The below primitives can be executed after the genesis of the Greenfield blockchain and enough SPs have registered themselves and started working properly.",source:"@site/docs/greenfield/design/storage-economics.md",sourceDirName:"greenfield/design",slug:"/greenfield/design/storage-economics",permalink:"/docs/greenfield/design/storage-economics",draft:!1,editUrl:"https://github.com/bnb-chain/bnb-chain.github.io/blob/master/docs/greenfield/design/storage-economics.md",tags:[],version:"current",frontMatter:{sidebar_label:"Storage Economics and Its Primitives"}},l={},c=[{value:"Account Creation",id:"account-creation",level:2},{value:"Data Object Creation",id:"data-object-creation",level:2},{value:"Data Storage",id:"data-storage",level:2},{value:"Data Read and Download",id:"data-read-and-download",level:2},{value:"Permissions and Group",id:"permissions-and-group",level:2},{value:"Fees and Payments",id:"fees-and-payments",level:2},{value:"Data Integrity and Availability Challenge",id:"data-integrity-and-availability-challenge",level:2},{value:"Data Delete",id:"data-delete",level:2}],d={toc:c},h="wrapper";function p(e){let{components:t,...o}=e;return(0,r.kt)(h,(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"storage-economics-and-its-primitives"},"Storage Economics and Its Primitives"),(0,r.kt)("p",null,"In this section, the underlying economics and the operating primitives are discussed aligned with the lifecycle of a data object. The below primitives can be executed after the genesis of the Greenfield blockchain and enough SPs have registered themselves and started working properly."),(0,r.kt)("h2",{id:"account-creation"},"Account Creation"),(0,r.kt)("p",null,"To write a data object into Greenfield, the users must have an account, or more specifically, an address on the BNB Greenfield blockchain. This can be done by transferring some BNB either from other addresses on Greenfield or from BSC."),(0,r.kt)("p",null,'This may be a special route that users can skip this step but issue the "',(0,r.kt)("strong",{parentName:"p"},"transfer and write"),'" request directly from BSC. As Greenfield and BSC share the same address protocol, this action de facto creates an account on Greenfield with the same address on BSC.'),(0,r.kt)("h2",{id:"data-object-creation"},"Data Object Creation"),(0,r.kt)("p",null,'Users must create "',(0,r.kt)("strong",{parentName:"p"},"Buckets"),'" before creating objects. Similar to the\n"',(0,r.kt)("strong",{parentName:"p"},"Bucket"),'" concepts in AWS S3, "',(0,r.kt)("strong",{parentName:"p"},"buckets"),'" here are a data resource to group data objects from a user. All the objects under the same bucket will be stored on the same primary SP and downloadable from that SP. Users can create many buckets and store their data objects in different ones.'),(0,r.kt)("p",null,"Each bucket has a Primary SP associated with it, which means all the\nobjects under this bucket will use that SP as the Primary SP. If the\nchosen Primary SP cannot serve the requests well, the user may choose to migrate the bucket to another SP completely via an on-chain transaction."),(0,r.kt)("p",null,"Data object creation is performed in two phases."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"1.")," ",(0,r.kt)("strong",{parentName:"p"},"Request phase:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"* Users establish the connection with the primary SP and send a\n")),(0,r.kt)("p",null,'"',(0,r.kt)("strong",{parentName:"p"},"get approval"),'" message to ask if it is willing to store the object; The primary SP acknowledges the request by signing a message about the operation and returns it to the client;'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'* After the primary SP determines to accept the request to store the data as the primary SP, the client constructs a "**write**" transaction message with the primary SP\'s signature and the initial object metadata, such as the object name, the bucket name, size, checksum, while optionally content type and the storage preference, etc; Users sign the transaction and submit it to Greenfield chain;\n\n* Users get the result of the transaction and transaction hash;\n\n* Greenfield accepts the "**create**" request and locks fees from users.\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"2.**")," Seal phase:**"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'* Users connect to the primary SP and send transaction hash; The primary SP uses the transaction hash to check if the object metadata is already created on Greenfield chain;\n\n* Users start uploading the object payload data to the primary SP if the object metadata is already created; The primary SP checks if the payload data matches the object\'s metadata by comparing the checksum of the object on Greenfield chain and the checksum of the payload data; If it matches the primary SP will sign the "**uploaded**" confirmation to the users;\n\n* The primary SP syncs with secondary SPs to set up the data redundancy, and then it signs a "**Seal**" transaction with the finalized metadata for storage. If the primary SP determines that it doesn\'t want to store the file due to whatever reason, it can also "**SealReject**" the request.\n\n* Greenfield processes the "**Seal**" or "**SealReject**" transaction to begin the storage life cycle for the object. Users can still "CancelRequest" to give up the creation request and get partially refunded.\n')),(0,r.kt)("p",null,"There are scenarios in which the primary SP doesn't cooperate with the user well:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"1.")," The primary SP acknowledges the upload request, but doesn't accept the upload in time; "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"2."),' The primary SP signs the "',(0,r.kt)("strong",{parentName:"p"},"uploaded"),'" confirmation but doesn\'t\nseal the transaction in time. Greenfield expects the primary SP to finish the object creation by either "',(0,r.kt)("strong",{parentName:"p"},"Seal"),'" or "',(0,r.kt)("strong",{parentName:"p"},"SealReject"),"\" transaction in a predefined time window; otherwise, the primary SP will be punished with a fine. Primary SP has no rational reasons to not acknowledge the upload request or doesn't seal in time, while the users have no rational reasons to create the requests but do not upload in time either."),(0,r.kt)("p",null,'There may be a special case in which the "',(0,r.kt)("strong",{parentName:"p"},"create"),'" is triggered from BSC as a cross-chain transaction, the primary SP cannot get requests\ndirectly. The primary SP can observe such requests and perform other\nactions in the same way.'),(0,r.kt)("h2",{id:"data-storage"},"Data Storage"),(0,r.kt)("p",null,'Once a data object is "',(0,r.kt)("strong",{parentName:"p"},"Sealed"),'", the owner of the object has de facto\nentered a contract with the SPs for the storage, in which case the\nowners should pay fees for such storage and the SPs should guarantee the data availability.'),(0,r.kt)("p",null,"The data object owners always have the right to change the primary SP to store their data, after settling the outstanding fees."),(0,r.kt)("p",null,"The SPs, especially the primary SPs, can also inform people to stop\nstoring the data, due to either their own opinions or decision. Both\nother SPs and the owners can observe corresponding notifications. Other SPs can voluntarily propose themselves to be successors to store the data objects on Greenfield if the owners do not react to the notification in a predefined time, as other SPs do like to take the business."),(0,r.kt)("h2",{id:"data-read-and-download"},"Data Read and Download"),(0,r.kt)("p",null,"By design, the bytes that are stored and downloaded later for the object are exactly the same bytes that were originally uploaded. SPs may use their encryption logic as they wish, but when the data is being downloaded, it shows the same bytes as it was uploaded. Users may choose their own encryption scheme or use the default one provided by the client software if they want the data to be unrecognizable by SPs or any others, even though SPs have the obligation to not circulate these data out of users' instruction."),(0,r.kt)("p",null,"Data objects can be only read and downloaded by the addresses with\nproper read permissions. The Primary SP of the objects is the main\nsource to download from. If Primary SP is not available, the owner and Greenfield blockchain validators can challenge (described in the ",(0,r.kt)("a",{parentName:"p",href:"/docs/greenfield/tech-specs/ecosystem-players"},"Technical Specifications"),") and change the object's primary SP to recover the downloading."),(0,r.kt)("p",null,"Each object has a time-based traffic bandwidth quota, which is provided free, i.e. nobody needs to pay for downloading a certain amount within a certain period. It is expected that this quota can satisfy most of the individual download needs as part of the normal usage conditions."),(0,r.kt)("p",null,"For extra bandwidth to download the object, someone has to pay for the data package, which is covered in the payment section."),(0,r.kt)("h2",{id:"permissions-and-group"},"Permissions and Group"),(0,r.kt)("p",null,"Permission is the main logic introduced in Greenfield to enable\npotential business models."),(0,r.kt)("p",null,"The data resources, including the objects, buckets, payment accounts, and groups, all have permissions related. These permissions define whether each account can perform particular actions."),(0,r.kt)("p",null,"Group is a list of accounts that can be treated in the same way as a\nsingle account."),(0,r.kt)("p",null,"Examples of permissions are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Put, List, Get, Delete, Copy, and Execute data objects;"),(0,r.kt)("li",{parentName:"ul"},"Create, Delete, and List buckets"),(0,r.kt)("li",{parentName:"ul"},"Create, Delete, ListMembersOf, Leave groups"),(0,r.kt)("li",{parentName:"ul"},"Create, Associate payment accounts"),(0,r.kt)("li",{parentName:"ul"},"Grant, Revoke the above permissions")),(0,r.kt)("p",null,"These permissions are associated with the data resources and\naccounts/groups, and the group definitions are stored on the Greenfield blockchain publicly. Now they are in plain text. Later a privacy modewill be introduced based on Zero Knowledge Proof technology."),(0,r.kt)("p",null,"One thing that makes the permission operation more interesting is that they can be operated from BSC directly, either through smart contracts or by an EOA."),(0,r.kt)("h2",{id:"fees-and-payments"},"Fees and Payments"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Payment-Stream-Flow",src:a(23827).Z,width:"1090",height:"422"})),(0,r.kt)("div",{align:"center"},(0,r.kt)("i",null,"Payment Stream Flow")),(0,r.kt)("p",null,"The storage fee will be charged on Greenfield in a steam payment style like ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"https://docs.superfluid.finance/superfluid/protocol-overview/in-depth-overview/super-agreements/constant-flow-agreement-cfa"},"Superfluid"))," ."),(0,r.kt)("p",null,'The fees are paid on Greenfield in the style of "Stream" from users to receiver accounts at a constant rate. The fees are "charged" every second as they are used.'),(0,r.kt)("p",null,"There are two kinds of fees for Greenfield: object storage fee and data package fee."),(0,r.kt)("p",null,"For storage, every object stored on Greenfield is charged at the price calculated by size, replica numbers, a base price ratio, and other parameters. Once the object is stored, the total charge of storage will be mainly only related to time and the base price."),(0,r.kt)("p",null,"For data downloading, there is a free, time-based quota for each bucket of users' objects. If it's exceeded, users can promote their data package to get more quota. Every data package has a fixed price for the defined period. Once the data package is picked, the total charge of downloading will be only related to time and the data package price, until the data package setting is changed again."),(0,r.kt)("p",null,"Here there is trust between the users and the SPs for data download. As the extra downloading bandwidth will charge a fee and the download journal is not fully stored on the Greenfield blockchain. SPs should provide an endpoint interface for users to query the download billing details with detailed logs and downloaders' signatures. If the users and the SPs cannot agree on the bill, users may just select another Primary SP."),(0,r.kt)("p",null,"By default, the object owner's address will be used to pay for the\nobjects it owns. But users can also create multiple \"",(0,r.kt)("strong",{parentName:"p"},"payment accounts"),'" and associate objects to different payment accounts to pay for storage and bandwidth.'),(0,r.kt)("p",null,"The address format of the payment account is the same as normal\naccounts. It's derived by the hash of the user address and payment\naccount index. However, the payment accounts are actually only logical ones and only exist in the storage payment module. Users can deposit into, withdraw from and query the balance of payment accounts on the Greenfield blockchain, but users cannot use payment accounts to perform staking or other on-chain transactions. Payment accounts can be set as \"",(0,r.kt)("strong",{parentName:"p"},"non-refundable"),'". Users cannot withdraw funds from such payment\naccounts.'),(0,r.kt)("p",null,'Other users can also sponsor the payment by donating a "stream payment" flow to selected "',(0,r.kt)("strong",{parentName:"p"},"non-refundable"),'" payment accounts. They can pause at any time they want.'),(0,r.kt)("p",null,"All the storage fees and data packages are priced and paid in BNB. There are system parameters and price oracles from the Greenfield Relayers (described below) to adjust the pricing based on the marketing situation."),(0,r.kt)("p",null,"Once the payment accounts run out of BNB, the objects associated with these payment accounts will suffer from a downgraded service of\ndownloading, i.e. the download speed and connection numbers will be\nlimited. Once the fund is transferred to the payment accounts, the\nservice quality can be resumed right away. If the service is not resumed for a long time, it is the SPs' discretionary decision to clear the data out, in a similar way to how SPs claim to stop services to certain objects. In such a case, the data may be gone from Greenfield completely."),(0,r.kt)("h2",{id:"data-integrity-and-availability-challenge"},"Data Integrity and Availability Challenge"),(0,r.kt)("p",null,"There are 3 aspects of ",(0,r.kt)("strong",{parentName:"p"},"data integrity"),", ",(0,r.kt)("strong",{parentName:"p"},"availability"),", and ",(0,r.kt)("strong",{parentName:"p"},"redundancy")," as listed below:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"1.")," The primary SP stores the correct object that the user uploaded."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"2.")," The SP stores assigned data segments either as the role of primary SP or secondary SP correctly, and the data pieces stored should not be missing, corrupted, or counterfeit."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"3.")," The Erasure Coding pieces stored in the secondary SPs can recover the original object stored in the primary SP."),(0,r.kt)("p",null,"The data integrity and redundancy should be first guarded by the\nchecksum and redundancy setup of the objects. They are part of the data object metadata, which should be verified by the SPs and users when the objects are created. This metadata will be stored on the Greenfield blockchain as well."),(0,r.kt)("p",null,'Both Greenfield and SPs have to work together to ensure data integrity and availability, especially for the above #2. Different from other decentralized storage systems, here a "Proof-of-Challenge" is introduced to build users\' confidence that the data is stored well as promised.'),(0,r.kt)("p",null,"Challengers can come from different stakeholders. Firstly, users can\nsubmit challenge transactions; secondly, similar to users, SPs can\nsubmit challenge transactions to other SPs; and lastly, Greenfield\nblockchain will issue internal challenge events randomly as well."),(0,r.kt)("p",null,"The challenge can be triggered by Greenfield transactions or internal events at the end of blocking. Once Greenfield validators observe such a challenge, they should run a standard off-chain check against the data from the SPs being challenged. These validators will vote for the challenge results via an aggregated multisig via an off-chain P2P network and submit them to the Greenfield blockchain. The failed result for a challenge will slash the corresponding SPs. The submitter and validators will get rewards for such challenges."),(0,r.kt)("p",null,"The data that failed the challenge will not be challenged within a\ncertain amount of time to give the SPs some time to recover."),(0,r.kt)("p",null,"Another section in ",(0,r.kt)("a",{parentName:"p",href:"/docs/greenfield/tech-specs/ecosystem-players"},"Technical Specifications")," will cover the data availability challenges in greater detail."),(0,r.kt)("h2",{id:"data-delete"},"Data Delete"),(0,r.kt)("p",null,"Users can request to delete their data objects. Greenfield will remove the metadata from the blockchain state, while the primary SP should respond to this request and drop all the replicas and redundant segments. The payment stream will be closed with a reward rebate to encourage the deletion in the future."))}p.isMDXComponent=!0},23827:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/6.6-Payment-Stream-Flow-da01fa9245e5ec2b003dde543fa05870.png"}}]);